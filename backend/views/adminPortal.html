<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Portal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center;
        }
        .button {
            display: inline-block;
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background-color: #4CAF50;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
        }
        .button:hover {
            background-color: #45a049;
        }
        .parking-space {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Welcome to the Admin Portal</h1>
    <p id="adminIdDisplay"></p>

    <a href="#" class="button" id="createParkingSpaceLink">Create Parking Space</a>
    <a href="#" class="button" id="accessCameraLink">Access Phone Camera</a>

    <h2>Your Parking Spaces</h2>
    <div id="parkingSpacesContainer"></div>

    <script>
        // Extract adminId from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const adminId = urlParams.get('adminId');
        document.getElementById('adminIdDisplay').innerText = `Admin ID: ${adminId}`;

        // Set up links with adminId
        document.getElementById('createParkingSpaceLink').href = `/addParkingSpace.html?adminId=${adminId}`;
        document.getElementById('accessCameraLink').href = `/accessCamera?adminId=${adminId}`;

        // Fetch and display parking spaces
        async function fetchParkingSpaces() {
            try {
                const response = await fetch(`/parking-spaces?adminId=${adminId}`);
                const parkingSpaces = await response.json();

                const container = document.getElementById('parkingSpacesContainer');
                container.innerHTML = ''; // Clear existing content

                if (parkingSpaces.length === 0) {
                    container.innerText = 'No parking spaces found.';
                } else {
                    parkingSpaces.forEach(space => {
                        const spaceDiv = document.createElement('div');
                        spaceDiv.className = 'parking-space';
                        spaceDiv.innerHTML = `
                            <strong>${space.locationName}</strong><br>
                            Location: ${space.latitude}, ${space.longitude}<br>
                            Capacity: ${space.regionCapacity}<br>
                            Price per Vehicle: $${space.pricePerVehicle}<br>
                            <button class="button" onclick="editParkingSpace('${space.PK}')">Edit</button>
                            <button class="button" onclick="deleteParkingSpace('${space.PK}')">Delete</button>
                        `;
                        container.appendChild(spaceDiv);
                    });
                }
            } catch (error) {
                console.error('Error fetching parking spaces:', error);
                document.getElementById('parkingSpacesContainer').innerText = 'Error loading parking spaces.';
            }
        }

        // Call the function to fetch parking spaces on page load
        fetchParkingSpaces();

        // Placeholder functions for edit and delete actions
        function editParkingSpace(spaceId) {
            alert(`Edit functionality for space ID: ${spaceId} is not implemented yet.`);
        }

        function deleteParkingSpace(spaceId) {
            alert(`Delete functionality for space ID: ${spaceId} is not implemented yet.`);
        }
    </script>
</body>
</html>